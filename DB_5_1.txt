演習5-1 正規化されたテーブルに対するSQL
演習3-3で正規化した以下の５つのテーブル（DB_3_3.xlsx）について考える

これら五つのテーブルから、以下の要件を満たす結果を得るためのSQLを考えよ
なお、テーブル名、列名、データの値は上記のテーブルのものを使用するものとする

SQL1 商品分類ごとの商品数。結果には分類名を含むものとする。
SELECT COUNT(商品.商品分類コード), 商品分類.分類名 FROM 商品
INNER JOIN 商品分類 ON 商品.商品分類コード = 商品分類.商品分類コード
GROUP BY 商品.商品分類コード;

SQL2 支社/支店別の取扱商品の一覧。結果には支社名、支店名、商品名を含むものとする。
SELECT 商品.商品名, 支社.支社名, 支店.支店名 FROM 支店商品
INNER JOIN 支社 ON 支社.支社コード = 支店商品.支社コード
INNER JOIN 支店 ON 支店.支店コード = 支店商品.支店コード
INNER JOIN 商品 ON 商品.商品コード = 支店商品.商品コード;

SQL3 最も取扱商品数が多い支店の支店コードと商品数。

SELECT 支店.支社コード, 支店.支店コード, COUNT(支店商品.商品コード) FROM 支店商品
INNER JOIN 支店 ON 支店.支社コード = 支店商品.支社コード
INNER JOIN 支店 ON 支店.支店コード = 支店商品.支店コード
GROUP BY 支店商品.支店コード, 支店商品.支社コード;
HAVING COUNT(支店商品.商品コード) >=
SELECT MAX(COUNT(支店商品.商品コード)) FROM (
SELECT 支店.支社コード, 支店.支店コード, COUNT(支店商品.商品コード) FROM 支店商品
INNER JOIN 支店 ON 支店.支社コード = 支店商品.支社コード
INNER JOIN 支店 ON 支店.支店コード = 支店商品.支店コード
GROUP BY 支店商品.支店コード, 支店商品.支社コード
);

